(this["webpackJsonpwebapp-admin"]=this["webpackJsonpwebapp-admin"]||[]).push([[0],{161:function(e,t,a){},169:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(28),l=a.n(s),o=a(4),i=a(5),c=a(7),u=a(6),m=a(13),d=a(8),h={zh:{},en:{account:"Account","account-description":"The authority-id for the account","account-keys":"Account Key Assertions",accounts:"Accounts",activate:"Activate",active:"Active",add:"Add","add-new-model":"Add a new model","add-new-signing-key":"Import a signing key","add-new-user":"Add a new user","api-key":"API Key","api-key-description":"API Key to sign a serial assertion request (min. 10 characters). Will be generated if blank or invalid",architecture:"Architecture","architecture-description":"The architecture of the device",assertion:"Assertion","assertion-settings":"Configure the model assertion headers","assertion-status":"Assertion Status","authority-id-description":"The authority for signing models","authority-id":"Signing Authority",base:"Base","base-description":"The name of the base snap",brand:"Brand","brand-description":"The name of the device brand",cancel:"Cancel",classic:"Classic","classic-description":"(optional) Ubuntu Classic system: true or false",close:"Close",complete:"Complete","confirm-log-delete":"Remove this log?","confirm-model-delete":"Remove this model?","confirm-store-delete":"Remove this sub-store model?","confirm-user-delete":"Remove this user?","copy-api-key":"Copy API key to clipboard","create-assertion":"Error creating the assertion","create-system-user":"Create System-User",date:"Date",deactivate:"Deactivate","delete-log":"Delete log","delete-model":"Delete model","delete-user":"Delete user",description:"The Serial Vault is a web service that generates cryptographically-signed serial assertions.",display_name:"Display Name","display_name-description":"Descriptive name of the device",download:"Download","edit-model":"Edit Model","edit-user":"Edit User",email:"Email","email-description":"Email for the Store","error-adding-key":"Error adding a public key","error-auth":"Unauthorized action","error-created-model":"Cannot find the created model","error-creating-model":"Error creating the model","error-creating-store":"Error creating the sub-store model","error-creating-user":"Error creating the user","error-decode-json":"Error decoding JSON","error-decode-key":"Error decoding the base64 Signing Key","error-deleting-key":"Error deleting a public key","error-fetch-models":"Error fetching the models","error-fetch-users":"Error fetching the users","error-format-assertions":"Error formatting the assertions","error-get-model":"Cannot find the model","error-get-non-user-accounts":"Cannot get user not related accounts","error-get-user":"Cannot find the user","error-invalid-model":"Invalid model ID","error-invalid-user":"Invalid user ID","error-key-data":"No data supplied for the public key","error-key-exists":"The ssh public key already exists","error-key-not-found":"The ssh public key cannot be found","error-model-data":"No model data supplied","error-model-exists":"A device with the same Brand and Model already exists","error-model-json":"Error with fields","error-model-not-active":"The model is linked with an inactive signing-key","error-model-not-found":"Cannot find model with the matching brand and model","error-nil-data":"Uninitialized POST data","error-no-permissions":"You do not have permissions to access this page","error-read-private-key":"Error reading the private key","error-sign-empty":"No data supplied for signing","error-signing-assertions":"Error signing the assertions","error-updating-model":"Error updating the model","error-updating-store":"Error updating sub-store model","error-updating-user":"Error updating the user","error-user-data":"No user data supplied","error-validate-key":"The public key must be entered","error-validate-model":"The Brand and Model must be supplied","error-validate-new-model":"The Brand, Model and Signing-Keys must be supplied","error-validate-signingkey":"The Serial Assertion Key must be selected","error-validate-userkey":"The System-User Assertion Key must be selected","find-serialnumber":"find serial number",fingerprint:"Fingerprint",gadget:"Gadget Snap","gadget-description":"The name of the gadget snap",generate:"Generate","generate-signing-key":"Generate Signing Key",home:"Home",inactive:"Inactive","invalid-keypair":"The signing-key is invalid",kernel:"Kernel Snap","kernel-description":"The name of the kernel snap","key-id":"Key ID","key-name-description":"Unique name for the key in the store","key-name":"Key Name","key-name-missing":"The key name must be entered",login:"Login",logout:"Logout",makes:"Brands","model-description":"The name of the device model",model:"Model",modelname:"Model Name","modelname-description":"The name of the pivoted model",models_available:"The following models are available",models:"Models",more:"More",name:"Full name","new-account-assertion":"Add or Replace Account Assertion","new-account-key-assertion":"Add or Replace Account Key Assertion","new-model":"New Model","new-public-key-description":"Paste the public key of the machine that needs access to the Serial Vault","new-public-key":"New Public Key","new-signing-key-description":"Paste the signing-key or upload the file","new-signing-key":"Import Signing Key","new-substore-device":"Create a new sub-store mapping for a device","new-user":"New User",no:"No","no-assertion-key":"No account key assertion found","no-assertion":"No account assertion found","no-assertions":"No assertions found","no-signing-keys-found":"No signing keys found","not-used-signing":"Not used for signing system-user assertions",otp:"OTP","otp-description":"One-time password for SSO",password:"Password","password-description":"Password for the Store","private-key-description":"The signing-key that will be used to sign the device identity","private-key-model":"Model Assertion Key","private-key-model-short":"Assertion","private-key":"Serial Assertion Key","private-key-short":"Serial Key","private-key-user-description":"The signing-key that will be used to sign the system-user assertion","private-key-user-short":"System-User Key","private-key-user":"System-User Assertion Key","public-key-confirm":"Confirm deletion of the public key","public-key-description":"Add a new public key","public-key":"Public Key","public-keys-authorized":"The following keys are authorized","public-keys":"Public Keys","register-signing-key":"Register Signing Key with the Store",remove:"Remove","required-snaps":"Required Snaps","required-snaps-description":"(optional) List of required snaps - enter a comma-separated list",reseller:"Reseller","reseller-features":"Enable Reseller Features",revision:"Revision","revision-description":"Revision of the assertion",role:"Role",save:"Save","select-accounts":"Select below the accounts this user belongs to:","serial-number-description":"Serial Number of the device","serial-number":"Serial Number",series:"Series","series-description":"Snap namespace series","signing-key":"Signing Key","signing-keys":"Signing Keys","signinglog-description":"Log of the serial numbers and device-key fingerprints that have been used",signinglog:"Signing Log",store:"Store","store-description":"ID of the brand store","store-account-assertion":"Account Assertion from Store","store-credentials":"Store Credentials","store-keypair":"Error storing the signing key",substore:"Sub-Store","substore-description":"Store ID of the Sub-Store","substore-model":"Sub-Store Model",substores:"Sub-Store Models",systemuser:"System-User",title:"Serial Vault","upload-account-assertion":"Upload Account Assertion","user-accounts":"User Accounts","user-email":"The email address of the user","user-key":"User Key","user-name":"The full name of the user",username:"Username","user-not-found":"You do not have permissions to access this site",users_available:"The following users are available",users:"Users",user:"User","user-username":"The nickname of the user",version:"Version",yes:"Yes"}},p=a(67),g=a.n(p),f=a(32),v=a.n(f),y={getToken:function(){return this.get("token")},getAuthToken:function(){return this.get("authtoken")},get:function(e,t){return t||(t={}),v()("GET","/v1/"+e,{headers:{},qs:t})},post:function(e,t){return this.getToken().then((function(a){return v()("POST","/v1/"+e,{headers:{"X-CSRF-Token":a.headers["x-csrf-token"]},json:t})}))},put:function(e,t){return this.getToken().then((function(a){return v()("PUT","/v1/"+e,{headers:{"X-CSRF-Token":a.headers["x-csrf-token"]},json:t})}))},delete:function(e,t){return this.getToken().then((function(a){return v()("DELETE","/v1/"+e,{headers:{"X-CSRF-Token":a.headers["x-csrf-token"]},json:t})}))}},E=100,k=150,b=200,N=300,C=["signing-keys","models","keypairs","accounts","signinglog","substores","systemuser","users","notfound"];function w(e){return"/"===e?"home":C.find((function(t){return e.startsWith("/".concat(t))}))||""}function S(e,t){var a=e.split("/").slice(1);return a[0]===t&&a[1]||""}function A(e){var t=window.AppState.getLocale();return h[t][e]||e}function D(e){return e.headers["content-type"].includes("json")?JSON.parse(e.body):{error_code:e.statusCode,message:e.body}}function O(e){var t=A(e.error_code);return e.error_subcode?t+=": "+A(e.error_subcode):e.message&&(t+=": "+e.message),t}function I(e){return j(e)}function j(e){return T(E,e)}function F(e){return T(b,e)}function K(e){return T(N,e)}function _(e){var t;switch(e){case E:t="Standard";break;case k:t="Sync API";break;case b:t="Admin";break;case N:t="Superuser";break;default:t="invalid role"}return t}function T(e,t){return!!t&&(!!t.role&&t.role>=e)}function M(e){sessionStorage.setItem("accountId",e.ID),sessionStorage.setItem("accountCode",e.AuthorityID),sessionStorage.setItem("accountAssertion",e.Assertion),sessionStorage.setItem("accountReseller",e.ResellerAPI)}function U(){return{ID:parseInt(sessionStorage.getItem("accountId"),10),AuthorityID:sessionStorage.getItem("accountCode"),Assertion:sessionStorage.getItem("accountAssertion"),ResellerAPI:"true"===sessionStorage.getItem("accountReseller")}}var x=["accounts","signing-keys","models","signinglog","users"],R=["accounts","signing-keys","models","signinglog"],P=["systemuser"],J=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleAccountChange=function(e){e.preventDefault();var t=parseInt(e.target.getAttribute("data-key"),10),n=a.props.accounts.filter((function(e){return e.ID===t}))[0];a.handleAccountMenu(),a.props.onAccountChange(n)},a.handleAccountMenu=function(e){e&&e.preventDefault(),a.setState({accountMenu:!a.state.accountMenu})},a.state={accountMenu:!1},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderAccounts",value:function(e){var t=this;if(!I(e))return r.a.createElement("span",null);if(0===this.props.accounts.length)return r.a.createElement("span",null);var a=this.props.selectedAccount.AuthorityID;return a.length>20&&(a=a.slice(0,20)+"..."),r.a.createElement("li",{className:"p-navigation__link account-menu"},r.a.createElement("a",{href:"/",onClick:this.handleAccountMenu,className:"p-contextual-menu__toggle","aria-controls":"#account-menu","aria-expanded":"false","aria-haspopup":"true"},a," ",r.a.createElement("i",{className:"fa fa-caret-down"}),this.state.accountMenu?r.a.createElement("span",{className:"p-contextual-menu__dropdown",id:"account-menu","aria-hidden":"false","aria-label":"submenu"},r.a.createElement("span",{className:"p-contextual-menu__group"},this.props.accounts.map((function(e){return r.a.createElement("a",{key:e.ID,"data-key":e.ID,href:"/",onClick:t.handleAccountChange,className:"p-contextual-menu__link"},e.AuthorityID)})))):""))}},{key:"render",value:function(){var e,t=this,a=this.props.token;switch(a.role){case b:e=R;break;case N:e=x;break;case E:e=P;break;default:e=[]}return r.a.createElement("ul",{className:"p-navigation__links"},this.renderAccounts(a),e.map((function(e){var a="";t.props.active===e&&(a=" active");var n="/"+e;return r.a.createElement("li",{key:e,className:"p-navigation__link"+a},r.a.createElement("a",{href:n},A(e)))})))}}]),t}(n.Component),L=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderUser",value:function(e){return I(e)?e.name?r.a.createElement("li",{className:"p-navigation__link"},r.a.createElement("a",{href:"https://login.ubuntu.com/",className:"p-link--external"},e.name)):void 0:r.a.createElement("li",{className:"p-navigation__link"},r.a.createElement("a",{href:"/login",className:"p-link--external"},A("login")))}},{key:"renderUserLogout",value:function(e){if(I(e)&&e.name)return r.a.createElement("li",{className:"p-navigation__link"},r.a.createElement("a",{href:"/logout"},A("logout")))}},{key:"render",value:function(){var e=this.props.token;return r.a.createElement("ul",{className:"p-navigation__links u-float-right"},this.renderUser(e),this.renderUserLogout(e))}}]),t}(n.Component),q={en:"English",zh:"Chinese"},Y=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleLanguageChange=function(e){e.preventDefault(),a.setState({language:e.target.value}),window.AppState.setLocale(e.target.value),window.AppState.rerender()},a.handleToggleMenu=function(e){e.preventDefault(),document.querySelector(".p-navigation__nav").classList.toggle("show")},a.state={language:window.AppState.getLocale()},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderLanguage",value:function(e){return this.state.language===e?r.a.createElement("button",{onClick:this.handleLanguageChange,value:e,className:"p-button--neutral"},q[e]):r.a.createElement("button",{onClick:this.handleLanguageChange,value:e},q[e])}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("header",{className:"p-navigation p-navigation--light",role:"banner"},r.a.createElement("div",{className:"p-navigation__logo"},r.a.createElement("a",{href:"/",className:"p-navigation__link"},r.a.createElement("img",{src:"/static/images/serial-vault-logo.svg",alt:A("title"),width:"180px",height:"44px"}))),r.a.createElement("a",{href:"#navigation",className:"p-navigation__toggle--open",title:"menu",onClick:this.handleToggleMenu},r.a.createElement("img",{src:"/static/images/navigation-menu-plain.svg",width:"30px",alt:"menu"})),r.a.createElement("nav",{className:"p-navigation__nav"},r.a.createElement("span",{className:"u-off-screen"},r.a.createElement("a",{href:"#navigation"},"Jump to site")),r.a.createElement(J,{token:this.props.token,accounts:this.props.accounts,selectedAccount:this.props.selectedAccount,onAccountChange:this.props.onAccountChange}),r.a.createElement(L,{token:this.props.token}))))}}]),t}(n.Component),B={version:function(){return console.log("Vault.version"),y.get("version")}},H=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={version:null},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getVersion()}},{key:"getVersion",value:function(){var e=this;B.version().then((function(t){var a=JSON.parse(t.body);e.setState({version:a.version})}))}},{key:"render",value:function(){return r.a.createElement("footer",{className:"spacer"},r.a.createElement("div",{className:"row"},r.a.createElement("p",null,r.a.createElement("small",null,A("version"),": ",this.state.version))))}}]),t}(n.Component),z=a(173),V=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.message?r.a.createElement("div",{className:"p-notification--negative"},r.a.createElement("p",{className:"p-notification__response"},this.props.message)):r.a.createElement("span",null)}}]),t}(n.Component),G=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={token:e.token||{}},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderUser",value:function(){return I(this.props.token)?r.a.createElement("div",null):r.a.createElement("div",null,r.a.createElement("a",{href:"/login",className:"p-button--brand"},A("login")))}},{key:"renderError",value:function(){if(this.props.error)return r.a.createElement(V,{message:A("user-not-found")})}},{key:"render",value:function(){return r.a.createElement("div",{className:"row"},r.a.createElement("section",{className:"row"},r.a.createElement("h2",null,r.a.createElement(z.a,{id:"title"})),this.renderError(),r.a.createElement("div",null,r.a.createElement("div",{className:"p-card"},r.a.createElement(z.a,{id:"description"})))),r.a.createElement("section",{className:"row"},this.renderUser()))}}]),t}(n.Component),Z=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e="p-button--brand",t="p-button--neutral";return this.props.small&&(e="p-button--brand small",t="p-button--neutral small"),this.props.message?r.a.createElement("div",{className:"p-card warning"},r.a.createElement("p",null,this.props.message),r.a.createElement("div",null,r.a.createElement("a",{href:"",onClick:this.props.handleCancelClick,className:t},A("no")),r.a.createElement("a",{href:"",onClick:this.props.handleYesClick,className:e},A("yes")))):r.a.createElement("span",null)}}]),t}(n.Component),X=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).copyToClipboard=function(e){e.preventDefault();var t=document.createElement("textarea");t.value=e.target.getAttribute("data-key"),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderActions",value:function(){return this.props.model.id!==this.props.confirmDelete?r.a.createElement("div",null,r.a.createElement("a",{href:"/models/".concat(this.props.model.id,"/edit"),className:"p-button--brand small",title:A("edit-model")},r.a.createElement("i",{className:"fa fa-pencil"})),"\xa0",r.a.createElement("a",{href:"",onClick:this.props.delete,"data-key":this.props.model.id,className:"p-button--neutral small",title:A("delete-model")},r.a.createElement("i",{className:"fa fa-trash","data-key":this.props.model.id}))):r.a.createElement(Z,{message:A("confirm-model-delete"),handleYesClick:this.props.deleteModel,handleCancelClick:this.props.cancelDelete,small:!0})}},{key:"render",value:function(){var e,t=this.props.model["key-id"],a=this.props.model["key-id-user"];return e=this.props.model["keypair-id-model"]>0?this.props.model["key-id-model"]:"",r.a.createElement("tr",null,r.a.createElement("td",null,this.renderActions()),r.a.createElement("td",{className:"overflow",title:this.props.model.model},r.a.createElement("a",{href:"",onClick:this.copyToClipboard,"data-key":this.props.model["api-key"],className:"p-button--neutral small",title:A("copy-api-key")},r.a.createElement("i",{className:"fa fa-clipboard","data-key":this.props.model["api-key"]})),"\xa0",this.props.model.model),r.a.createElement("td",{className:"overflow",title:t},t),r.a.createElement("td",{className:"overflow",title:a},a),r.a.createElement("td",null,this.props.model["key-active"]&&this.props.model["key-active-user"]?r.a.createElement("i",{className:"fa fa-check"}):r.a.createElement("i",{className:"fa fa-times"})),r.a.createElement("td",{className:"overflow",title:e},r.a.createElement("a",{href:"",className:"p-button--neutral small",title:A("assertion-settings"),"data-key":this.props.model.id,onClick:this.props.showAssert},r.a.createElement("i",{className:"fa fa-sliders","aria-hidden":"true","data-key":this.props.model.id}))))}}]),t}(n.Component),W={url:"keypairs",list:function(){return y.get(this.url)},get:function(e){return y.get(this.url+"/"+e,{})},update:function(e){return y.put(this.url+"/"+e.ID,e)},enable:function(e){return y.post(this.url+"/"+e+"/enable",{})},disable:function(e){return y.post(this.url+"/"+e+"/disable",{})},create:function(e,t,a){return y.post(this.url,{"authority-id":e,"private-key":t,"key-name":a})},generate:function(e,t){return y.post(this.url+"/generate",{"authority-id":e,"key-name":t})},status:function(){return y.get(this.url+"/status")},assertion:function(e,t){return y.post(this.url+"/assertion",{id:e,assertion:t})},register:function(e){return y.post(this.url+"/register",e)}},$={url:"models",list:function(){return y.get(this.url)},get:function(e){return y.get(this.url+"/"+e)},update:function(e){return y.put(this.url+"/"+e.id,e)},delete:function(e){return y.delete(this.url+"/"+e.id,{})},create:function(e){return y.post(this.url,e)},assertion:function(e){return y.post(this.url+"/assertion",e)}},Q=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChangePrivateKeyModel=function(e){var t=a.state.assertion;t.keypair_id=parseInt(e.target.value,10),a.setState({assertion:t})},a.handleChangeSeries=function(e){var t=a.state.assertion;t.series=parseInt(e.target.value,10),a.setState({assertion:t})},a.handleChangeArchitecture=function(e){var t=a.state.assertion;t.architecture=e.target.value,a.setState({assertion:t})},a.handleChangeRevision=function(e){var t=a.state.assertion;t.revision=parseInt(e.target.value,10),a.setState({assertion:t})},a.handleChangeBase=function(e){var t=a.state.assertion;t.base=e.target.value,a.setState({assertion:t})},a.handleChangeClassic=function(e){var t=a.state.assertion;t.classic=e.target.value,a.setState({assertion:t})},a.handleBlurClassic=function(e){var t=a.state.assertion;switch(e.target.value.toLowerCase()){case"":t.classic="";break;case"false":case"no":t.classic="false";break;default:t.classic="true"}a.setState({assertion:t})},a.handleChangeDisplayName=function(e){var t=a.state.assertion;t.display_name=e.target.value,a.setState({assertion:t})},a.handleChangeGadget=function(e){var t=a.state.assertion;t.gadget=e.target.value,a.setState({assertion:t})},a.handleChangeKernel=function(e){var t=a.state.assertion;t.kernel=e.target.value,a.setState({assertion:t})},a.handleChangeStore=function(e){var t=a.state.assertion;t.store=e.target.value,a.setState({assertion:t})},a.handleChangeSnaps=function(e){var t=a.state.assertion;t.required_snaps=e.target.value,a.setState({assertion:t})},a.handleSave=function(e){e.preventDefault(),F(a.props.token)||(window.location="/models"),$.assertion(a.state.assertion).then((function(e){var t=JSON.parse(e.body);console.log(t),e.statusCode>=300?a.setState({error:O(t)}):window.location="/models"}))};var n={};return a.props.model&&a.props.model.assertion&&(n=a.props.model.assertion),n.model_id||(n.model_id=a.props.model.id),a.state={error:null,keypairs:[],assertion:n},a.getKeypairs(),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getKeypairs",value:function(){var e=this;W.list().then((function(t){var a=JSON.parse(t.body),n="";a.success||(n=a.message);var r=a.keypairs.filter((function(t){return t.AuthorityID===e.props.model["brand-id"]}));e.setState({keypairs:r,message:n})}))}},{key:"render",value:function(){var e=this.state.assertion;return r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"7"},r.a.createElement("h5",null,A("assertion-settings")),r.a.createElement(V,{message:this.state.error}),r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"keypair-model"},A("private-key-model"),":",r.a.createElement("select",{value:e.keypair_id,id:"keypair-model",onChange:this.handleChangePrivateKeyModel},r.a.createElement("option",null),this.state.keypairs.map((function(e){return e.Active?r.a.createElement("option",{key:e.ID,value:e.ID},e.AuthorityID,"/",e.KeyID):r.a.createElement("option",{key:e.ID,value:e.ID},e.AuthorityID,"/",e.KeyID," (",A("inactive"),")")})))),r.a.createElement("label",{htmlFor:"series"},A("series"),":",r.a.createElement("input",{type:"number",id:"series",placeholder:A("series-description"),min:"16",value:e.series,onChange:this.handleChangeSeries})),r.a.createElement("label",{htmlFor:"base"},A("base"),":",r.a.createElement("input",{type:"text",id:"base",placeholder:A("base-description"),value:e.base,onChange:this.handleChangeBase})),r.a.createElement("label",{htmlFor:"classic"},A("classic"),":",r.a.createElement("input",{type:"text",id:"classic",placeholder:A("classic-description"),value:e.classic,onChange:this.handleChangeClassic,onBlur:this.handleBlurClassic})),r.a.createElement("label",{htmlFor:"display_name"},A("display_name"),":",r.a.createElement("input",{type:"text",id:"display_name",placeholder:A("display_name-description"),value:e.display_name,onChange:this.handleChangeDisplayName})),r.a.createElement("label",{htmlFor:"architecture"},A("architecture"),":",r.a.createElement("input",{type:"text",id:"architecture",placeholder:A("architecture-description"),value:e.architecture,onChange:this.handleChangeArchitecture})),r.a.createElement("label",{htmlFor:"revision"},A("revision"),":",r.a.createElement("input",{type:"number",id:"revision",placeholder:A("revision-description"),value:e.revision,onChange:this.handleChangeRevision})),r.a.createElement("label",{htmlFor:"gadget"},A("gadget"),":",r.a.createElement("input",{type:"text",id:"gadget",placeholder:A("gadget-description"),value:e.gadget,onChange:this.handleChangeGadget})),r.a.createElement("label",{htmlFor:"kernel"},A("kernel"),":",r.a.createElement("input",{type:"text",id:"kernel",placeholder:A("kernel-description"),value:e.kernel,onChange:this.handleChangeKernel})),r.a.createElement("label",{htmlFor:"store"},A("store"),":",r.a.createElement("input",{type:"text",id:"store",placeholder:A("store-description"),value:e.store,onChange:this.handleChangeStore})),r.a.createElement("label",{htmlFor:"required-snaps"},A("required-snaps"),":",r.a.createElement("textarea",{onChange:this.handleChangeSnaps,defaultValue:e.required_snaps,name:"required-snaps",placeholder:A("required-snaps-description")}))),F(this.props.token)?r.a.createElement("span",null,r.a.createElement("button",{className:"p-button--neutral",onClick:this.props.cancel,"data-key":e.model_id},A("cancel")),r.a.createElement("button",{className:"p-button--brand",onClick:this.handleSave,"data-key":e.model_id},A("save"))):r.a.createElement("button",{className:"p-button--neutral",onClick:this.props.cancel,"data-key":e.model_id},A("close")))))}}]),t}(n.Component),ee=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleRefresh=function(){a.refresh()},a.handleShowAssert=function(e){e.preventDefault();var t=parseInt(e.target.getAttribute("data-key"),10);a.state.showAssert===t?a.setState({showAssert:null}):a.setState({showAssert:t})},a.handleDelete=function(e){e.preventDefault(),a.setState({confirmDelete:parseInt(e.target.getAttribute("data-key"),10)})},a.handleDeleteModel=function(e){e.preventDefault();var t=a.props.models.filter((function(e){return e.id===a.state.confirmDelete}));0!==t.length&&$.delete(t[0]).then((function(e){var t=JSON.parse(e.body);e.statusCode>=300||!t.success?a.setState({message:a.formatError(t)}):window.location="/models"}))},a.handleDeleteModelCancel=function(e){e.preventDefault(),a.setState({confirmDelete:null})},a.state={confirmDelete:null,message:null,showAssert:null},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){}},{key:"formatError",value:function(e){var t=A(e.error_code);return e.error_subcode?t+=": "+A(e.error_subcode):e.message&&(t+=": "+e.message),t}},{key:"renderTable",value:function(){var e=this;return this.props.models.length>0?r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,A("model")),r.a.createElement("th",null,A("private-key-short")),r.a.createElement("th",null,A("private-key-user-short")),r.a.createElement("th",{className:"small"},A("active")),r.a.createElement("th",null,A("private-key-model-short")))),this.props.models.map((function(t){return r.a.createElement("tbody",null,r.a.createElement(X,{key:t.id,model:t,delete:e.handleDelete,confirmDelete:e.state.confirmDelete,deleteModel:e.handleDeleteModel,cancelDelete:e.handleDeleteModelCancel,showAssert:e.handleShowAssert}),e.state.showAssert===t.id?r.a.createElement(Q,{model:t,token:e.props.token,cancel:e.handleShowAssert}):"")}))):r.a.createElement("p",null,"No models found.")}},{key:"render",value:function(){return F(this.props.token)?r.a.createElement("div",{className:"row"},r.a.createElement("section",{className:"row"},r.a.createElement("div",{className:"u-equal-height"},r.a.createElement("h2",{className:"col-3"},A("models")),"\xa0",r.a.createElement("div",{className:"col-1"},r.a.createElement("a",{href:"/models/new",className:"p-button--brand",title:A("add-new-model")},r.a.createElement("i",{className:"fa fa-plus"})))),r.a.createElement("div",{className:"col-12"},r.a.createElement("p",null,A("models_available"),":")),r.a.createElement("div",{className:"col-12"},r.a.createElement(V,{message:this.state.message})),r.a.createElement("div",{className:"col-12"},this.renderTable()))):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),te=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChangeBrand=function(e){var t=a.state.model;t["brand-id"]=e.target.value,a.setState({model:t})},a.handleChangeModel=function(e){var t=a.state.model;t.model=e.target.value,a.setState({model:t})},a.handleChangeAPIKey=function(e){var t=a.state.model;t["api-key"]=e.target.value,a.setState({model:t})},a.handleChangePrivateKey=function(e){var t=a.state.model;t["keypair-id"]=parseInt(e.target.value,10),a.setState({model:t})},a.handleChangePrivateKeyUser=function(e){var t=a.state.model;t["keypair-id-user"]=parseInt(e.target.value,10),a.setState({model:t})},a.handleSaveClick=function(e){e.preventDefault();var t=Object(m.a)(a);a.state.model.id?$.update(a.state.model).then((function(e){var a=JSON.parse(e.body);e.statusCode>=300?t.setState({error:t.formatError(a)}):window.location="/models"})):$.create(a.state.model).then((function(e){var a=JSON.parse(e.body);e.statusCode>=300?t.setState({error:t.formatError(a)}):window.location="/models"}))},a.state={title:null,model:{"brand-id":a.props.selectedAccount.AuthorityID},error:null,hideForm:!1},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.id?(this.setTitle("edit-model"),this.getModel(this.props.id)):this.setTitle("new-model")}},{key:"setTitle",value:function(e){this.setState({title:A(e)})}},{key:"getModel",value:function(e){var t=this;$.get(e).then((function(e){var a=JSON.parse(e.body);e.statusCode>=300?t.setState({error:t.formatError(a),hideForm:!0}):t.setState({model:a.model,hideForm:!1})}))}},{key:"formatError",value:function(e){var t=A(e.error_code);return e.error_subcode&&(t+=": "+A(e.error_subcode)),e.message&&(t+=": "+e.message),t}},{key:"renderError",value:function(){if(this.state.error)return r.a.createElement(V,{message:this.state.error})}},{key:"render",value:function(){return F(this.props.token)?this.state.hideForm?r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:this.state.error})):r.a.createElement("div",{className:"row"},r.a.createElement("section",{className:"row"},r.a.createElement("h2",null,this.state.title),r.a.createElement(V,{message:this.state.error}),r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"brand"},A("brand"),":",r.a.createElement("input",{type:"text",id:"brand",placeholder:A("brand-description"),disabled:!0,value:this.state.model["brand-id"],onChange:this.handleChangeBrand})),r.a.createElement("label",{htmlFor:"model"},A("model"),":",r.a.createElement("input",{type:"text",id:"model",placeholder:A("model-description"),value:this.state.model.model,onChange:this.handleChangeModel})),r.a.createElement("label",{htmlFor:"model"},A("api-key"),":",r.a.createElement("input",{type:"text",id:"api-key",placeholder:A("api-key-description"),value:this.state.model["api-key"],onChange:this.handleChangeAPIKey})),r.a.createElement("label",{htmlFor:"keypair"},A("private-key"),":",r.a.createElement("select",{value:this.state.model["keypair-id"],id:"keypair",onChange:this.handleChangePrivateKey},r.a.createElement("option",null),this.props.keypairs.map((function(e){return e.Active?r.a.createElement("option",{key:e.ID,value:e.ID},e.KeyName," - ",e.KeyID):r.a.createElement("option",{key:e.ID,value:e.ID},e.KeyName," - ",e.KeyID," (",A("inactive"),")")})))),r.a.createElement("label",{htmlFor:"keypair-user"},A("private-key-user"),":",r.a.createElement("select",{value:this.state.model["keypair-id-user"],id:"keypair-user",onChange:this.handleChangePrivateKeyUser},r.a.createElement("option",null),this.props.keypairs.map((function(e){return e.Active?r.a.createElement("option",{key:e.ID,value:e.ID},e.KeyName," - ",e.KeyID):r.a.createElement("option",{key:e.ID,value:e.ID},e.KeyName," - ",e.KeyID," (",A("inactive"),")")})))))),r.a.createElement("div",null,r.a.createElement("a",{href:"/models",className:"p-button--neutral"},A("cancel")),"\xa0",r.a.createElement("a",{href:"/models",onClick:this.handleSaveClick,className:"p-button--brand"},A("save")))),r.a.createElement("br",null)):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),ae=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChangeAuthorityId=function(e){a.setState({authorityId:e.target.value})},a.handleChangeKeyName=function(e){a.setState({name:e.target.value})},a.handleChangeKey=function(e){a.setState({key:e.target.value})},a.handleFileUpload=function(e){var t=Object(m.a)(a),n=new FileReader,r=e.target.files[0];n.onload=function(e){t.setState({key:e.target.result.split(",")[1]})},n.readAsDataURL(r)},a.handleSaveClick=function(e){e.preventDefault(),W.create(a.props.selectedAccount.AuthorityID,a.state.key,a.state.name).then((function(e){var t=JSON.parse(e.body);e.statusCode>=300||!t.success?a.setState({error:a.formatError(t)}):window.location="/signing-keys"}))},a.formatError=function(e){var t=A(e.error_code);return e.error_subcode?t+=": "+A(e.error_subcode):e.message&&(t+=": "+e.message),t},a.state={name:null,key:null,error:a.props.error},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getAccounts",value:function(){return this.props.selectedAccount.ID?[this.props.selectedAccount]:[]}},{key:"render",value:function(){return F(this.props.token)?r.a.createElement("div",null,r.a.createElement("section",{className:"row no-border"},r.a.createElement("h2",null,A("new-signing-key")),r.a.createElement("div",{className:"col-12"},r.a.createElement(V,{message:this.state.error}),r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"name"},A("key-name"),":",r.a.createElement("input",{type:"text",id:"name",onChange:this.handleChangeKeyName,value:this.state.name,placeholder:A("key-name-description")})),r.a.createElement("label",{htmlFor:"authority-id"},A("authority-id"),":",r.a.createElement("select",{value:this.props.selectedAccount.AuthorityID,id:"authority-id",onChange:this.handleChangeAuthorityId},this.getAccounts().map((function(e){return r.a.createElement("option",{key:e.AuthorityID,value:e.AuthorityID},e.AuthorityID)})))),r.a.createElement("label",{htmlFor:"key"},A("signing-key"),":",r.a.createElement("textarea",{onChange:this.handleChangeKey,defaultValue:this.state.key,id:"key",placeholder:A("new-signing-key-description")}),r.a.createElement("input",{type:"file",onChange:this.handleFileUpload})))),r.a.createElement("div",null,r.a.createElement("a",{href:"/signing-keys",className:"p-button--neutral"},A("cancel")),"\xa0",r.a.createElement("a",{href:"/signing-keys",onClick:this.handleSaveClick,className:"p-button--brand"},A("save"))))),r.a.createElement("br",null)):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChangeKeyName=function(e){var t=a.state.keypair;t.KeyName=e.target.value,a.setState({keypair:t})},a.handleSaveClick=function(e){e.preventDefault(),W.update(a.state.keypair).then((function(e){var t=JSON.parse(e.body);e.statusCode>=300||!t.success?a.setState({error:a.formatError(t)}):window.location="/signing-keys"}))},a.formatError=function(e){var t=A(e.error_code);return e.error_subcode?t+=": "+A(e.error_subcode):e.message&&(t+=": "+e.message),t},a.state={keypair:{},error:null},a.getKeypair(a.props.id),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getKeypair",value:function(e){var t=this;W.get(e).then((function(e){var a=JSON.parse(e.body);e.statusCode>=300?t.setState({error:t.formatError(a),hideForm:!0}):t.setState({keypair:a.keypair,hideForm:!1})}))}},{key:"render",value:function(){return F(this.props.token)?this.state.hideForm?r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:this.state.error})):r.a.createElement("div",{className:"row"},r.a.createElement("section",{className:"row"},r.a.createElement("h2",null,A("edit-signing-key")),r.a.createElement(V,{message:this.state.error}),r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"name"},A("key-name"),":",r.a.createElement("input",{type:"text",id:"name",onChange:this.handleChangeKeyName,value:this.state.keypair.KeyName,placeholder:A("key-name-description")})),r.a.createElement("label",{htmlFor:"authority-id"},A("authority-id"),":",r.a.createElement("input",{type:"text",id:"authority-id",placeholder:A("authority-id-description"),value:this.state.keypair.AuthorityID,disabled:!0})))),r.a.createElement("div",null,r.a.createElement("a",{href:"/signing-keys",className:"p-button--neutral"},A("cancel")),"\xa0",r.a.createElement("a",{href:"/signing-keys",onClick:this.handleSaveClick,className:"p-button--brand"},A("save"))))):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),re=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChangeAuthorityId=function(e){a.setState({authorityId:e.target.value})},a.handleChangeKeyName=function(e){a.setState({keyName:e.target.value})},a.handleSaveClick=function(e){var t=Object(m.a)(a);e.preventDefault(),W.generate(a.props.selectedAccount.AuthorityID,a.state.keyName).then((function(e){var a=JSON.parse(e.body);e.statusCode>=300||!a.success?t.setState({error:t.formatError(a)}):window.location="/signing-keys"}))},a.formatError=function(e){var t=A(e.error_code);return e.error_subcode?t+=": "+A(e.error_subcode):e.message&&(t+=": "+e.message),t},a.state={keyName:null,error:a.props.error},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getAccounts",value:function(){return this.props.selectedAccount.ID?[this.props.selectedAccount]:[]}},{key:"render",value:function(){return F(this.props.token)?r.a.createElement("div",null,r.a.createElement("section",{className:"row no-border"},r.a.createElement("h2",null,A("generate-signing-key")),r.a.createElement("div",{className:"col-12"},r.a.createElement(V,{message:this.state.error}),r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"authority-id"},A("authority-id"),":",r.a.createElement("select",{value:this.props.selectedAccount.AuthorityID,id:"authority-id",onChange:this.handleChangeAuthorityId},this.getAccounts().map((function(e){return r.a.createElement("option",{key:e.AuthorityID,value:e.AuthorityID},e.AuthorityID)})))),r.a.createElement("label",{htmlFor:"key-name"},A("key-name"),":",r.a.createElement("input",{type:"text",id:"key-name",onChange:this.handleChangeKeyName,placeholder:A("key-name-description")})))),r.a.createElement("div",null,r.a.createElement("a",{href:"/signing-keys",className:"p-button--neutral"},A("cancel")),"\xa0",r.a.createElement("a",{href:"/signing-keys",onClick:this.handleSaveClick,className:"p-button--brand"},A("generate"))))),r.a.createElement("br",null)):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),se=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChangeKey=function(e){var t=parseInt(e.target.value,10),n=a.props.keypairs.filter((function(e){return e.ID===t}));if(n.length>0){var r=a.keyFromKeypair(n[0]);a.setState({keypair:r})}},a.handleChangeName=function(e){var t=a.state.keypair;t.KeyName=e.target.value,a.setState({keypair:t})},a.handleChangeEmail=function(e){var t=a.state.keypair;t.email=e.target.value,a.setState({keypair:t})},a.handleChangePassword=function(e){var t=a.state.keypair;t.password=e.target.value,a.setState({keypair:t})},a.handleChangeOTP=function(e){var t=a.state.keypair;t.otp=e.target.value,a.setState({keypair:t})},a.handleSaveClick=function(e){e.preventDefault(),W.register(a.state.keypair).then((function(e){var t=JSON.parse(e.body);e.statusCode>=300||!t.success?a.setState({error:O(t)}):window.location="/signing-keys"}))};var n={};return a.props.keypairs.length>0&&(n=a.keyFromKeypair(a.props.keypairs[0])),a.state={keypair:n},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"keyFromKeypair",value:function(e){return{"authority-id":e.AuthorityID,"key-name":e.KeyName}}},{key:"render",value:function(){return F(this.props.token)?r.a.createElement("div",null,r.a.createElement("section",{className:"row no-border"},r.a.createElement("h2",null,A("register-signing-key")),r.a.createElement("div",{className:"col-12"},r.a.createElement(V,{message:this.state.error}),r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"keypair"},A("signing-key"),":",r.a.createElement("select",{value:this.state.keypair.ID,id:"keypair",onChange:this.handleChangeKey},r.a.createElement("option",null),this.props.keypairs.map((function(e){return e.Active?r.a.createElement("option",{key:e.ID,value:e.ID},e.AuthorityID,"/",e.KeyID):r.a.createElement("option",{key:e.ID,value:e.ID},e.AuthorityID,"/",e.KeyID," (",A("inactive"),")")})))),r.a.createElement("label",{htmlFor:"key-name"},A("key-name"),":",r.a.createElement("input",{type:"text",id:"key-name",onChange:this.handleChangeName,placeholder:A("key-name-description"),value:this.state.keypair["key-name"]})),r.a.createElement("h3",null,A("store-credentials")),r.a.createElement("label",{htmlFor:"email"},A("email"),":",r.a.createElement("input",{type:"email",id:"email",onChange:this.handleChangeEmail,placeholder:A("email-description"),value:this.state.keypair.email})),r.a.createElement("label",{htmlFor:"password"},A("password"),":",r.a.createElement("input",{type:"password",id:"password",onChange:this.handleChangePassword,placeholder:A("password-description"),value:this.state.keypair.password})),r.a.createElement("label",{htmlFor:"otp"},A("otp"),":",r.a.createElement("input",{type:"text",id:"otp",onChange:this.handleChangeOTP,placeholder:A("otp-description"),value:this.state.keypair.otp})))),r.a.createElement("div",null,r.a.createElement("a",{href:"/signing-keys",className:"p-button--neutral"},A("cancel")),"\xa0",r.a.createElement("a",{href:"/signing-keys",onClick:this.handleSaveClick,className:"p-button--brand"},A("save"))))),r.a.createElement("br",null)):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),le=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={models:e.models||[],message:""},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getModels()}},{key:"getAccounts",value:function(){return this.props.selectedAccount.ID?[this.props.selectedAccount]:[]}},{key:"getModels",value:function(){var e=this;$.list().then((function(t){var a=JSON.parse(t.body),n="";a.success||(n=a.message),e.setState({models:a.models,message:n})}))}},{key:"renderKeyStatus",value:function(e){if(!this.state.models.find((function(t){return t["authority-id-user"]===e.AuthorityID&t["key-id-user"]===e.KeyID})))return r.a.createElement("p",null,A("not-used-signing"));var t=[];return this.getAccounts().find((function(t){return t.AuthorityID===e.AuthorityID}))||t.push(A("no-assertion")),e.Assertion&&0!==e.Assertion.length||t.push(A("no-assertion-key")),0===t.length?r.a.createElement("div",null,r.a.createElement("p",{title:e.Assertion},r.a.createElement("i",{className:"fa fa-check information positive"})," ",A("complete"))):r.a.createElement("div",null,t.map((function(e,t,a){return r.a.createElement("p",{key:t},r.a.createElement("i",{className:"fa fa-exclamation-triangle warning"})," ",e)})))}},{key:"renderAccounts",value:function(){var e=this;return this.getAccounts().length>0?r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,F(this.props.token)?r.a.createElement("th",{className:"small"}):"",r.a.createElement("th",null,A("account")),r.a.createElement("th",null,A("assertion-status")),r.a.createElement("th",{className:"small"},A("reseller")))),r.a.createElement("tbody",null,this.getAccounts().map((function(t){return r.a.createElement("tr",{key:t.ID},F(e.props.token)?r.a.createElement("td",null,r.a.createElement("div",null,r.a.createElement("a",{href:"/accounts/account/"+t.ID,className:"p-button--brand small",title:A("edit-account")},r.a.createElement("i",{className:"fa fa-pencil"})))):"",r.a.createElement("td",null,t.AuthorityID),r.a.createElement("td",null,r.a.createElement("p",{title:t.Assertion},r.a.createElement("i",{className:"fa fa-check information positive"})," ",A("complete"))),r.a.createElement("td",null,t.ResellerAPI?r.a.createElement("i",{className:"fa fa-check"}):r.a.createElement("i",{className:"fa fa-times"})))})))):r.a.createElement("p",null,A("no-assertions"))}},{key:"renderAccountKeys",value:function(){var e=this;return this.props.keypairs.length>0?r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,A("key-id")),r.a.createElement("th",null,A("assertion-status")),r.a.createElement("th",{className:"small"},A("reseller")))),r.a.createElement("tbody",null,this.props.keypairs.map((function(t){return r.a.createElement("tr",{key:t.ID},r.a.createElement("td",{className:"overflow"},t.AuthorityID,r.a.createElement("br",null),t.KeyID),r.a.createElement("td",null,e.renderKeyStatus(t)),r.a.createElement("td",null,t.ResellerAPI?r.a.createElement("i",{className:"fa fa-check"}):r.a.createElement("i",{className:"fa fa-times"})))})))):r.a.createElement("p",null,A("no-assertions"))}},{key:"render",value:function(){return F(this.props.token)?r.a.createElement("div",{className:"row",ref:"root"},r.a.createElement("section",{className:"row"},r.a.createElement("div",{className:"u-equal-height"},r.a.createElement("h2",{className:"col-5"},A("accounts")),"\xa0",r.a.createElement("div",{className:"col-1"},r.a.createElement("a",{href:"/accounts/new",className:"p-button--brand",title:A("new-account-assertion")},r.a.createElement("i",{className:"fa fa-plus"}))),r.a.createElement("div",{className:"col-1"},r.a.createElement("a",{href:"/accounts/upload",className:"p-button--brand",title:A("upload-account-assertion")},r.a.createElement("i",{className:"fa fa-upload"})))),r.a.createElement("div",{className:"col-12"},this.renderAccounts())),r.a.createElement("section",{className:"row"},r.a.createElement("div",{className:"u-equal-height"},r.a.createElement("h2",{className:"col-5"},A("account-keys")),"\xa0",r.a.createElement("div",{className:"col-1"},r.a.createElement("a",{href:"/accounts/key-assertion",className:"p-button--brand",title:A("new-account-assertion")},r.a.createElement("i",{className:"fa fa-plus"})))),r.a.createElement("div",{className:"col-12"},this.renderAccountKeys()))):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),oe={url:"accounts",list:function(){return y.get(this.url)},get:function(e){return y.get(this.url+"/"+e)},create:function(e){return y.post(this.url,e)},update:function(e){return y.put(this.url+"/"+e.ID,e)},upload:function(e){return y.post(this.url+"/upload",{assertion:e})},stores:function(e){return y.get(this.url+"/"+e+"/stores")},storeNew:function(e,t){return t.accountID=parseInt(e,10),y.post(this.url+"/stores",t)},storeUpdate:function(e){return y.put(this.url+"/stores/"+e.id,e)},storeDelete:function(e){return y.delete(this.url+"/stores/"+e.id,{})}},ie=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleFileUpload=function(e){var t=new FileReader,n=e.target.files[0];t.onload=function(e){a.setState({assertion:e.target.result.split(",")[1]})},t.readAsDataURL(n)},a.handleSaveClick=function(e){e.preventDefault(),oe.upload(a.state.assertion).then((function(e){var t=D(e);t.success?window.location="/accounts":a.setState({error:O(t)})}))},a.state={assertion:null,error:null},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return F(this.props.token)?r.a.createElement("div",null,r.a.createElement("section",{className:"row no-border"},r.a.createElement("h2",null,A("new-account-assertion")),r.a.createElement("div",{className:"col-12"},r.a.createElement(V,{message:this.state.error}),r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"key"},A("assertion"),":",r.a.createElement("input",{type:"file",onChange:this.handleFileUpload})))),r.a.createElement("div",null,r.a.createElement("a",{href:"/accounts",className:"p-button--neutral"},A("cancel")),"\xa0",r.a.createElement("a",{href:"/accounts",onClick:this.handleSaveClick,className:"p-button--brand"},A("save"))))),r.a.createElement("br",null)):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChangeAccount=function(e){var t=a.state.account;t.AuthorityID=e.target.value,a.setState({account:t})},a.handleChangeReseller=function(e){var t=a.state.account;t.ResellerAPI=e.target.checked,a.setState({account:t})},a.handleSaveClick=function(e){e.preventDefault(),a.state.account.ID?oe.update(a.state.account).then((function(e){var t=D(e);t.success?window.location="/accounts":a.setState({error:O(t)})})):oe.create(a.state.account).then((function(e){var t=D(e);t.success?window.location="/accounts":a.setState({error:O(t)})}))},a.state={account:{},error:null},a.props.id&&a.getAccount(a.props.id),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getAccount",value:function(e){var t=this;oe.get(e).then((function(e){var a=JSON.parse(e.body);e.statusCode>=300?t.setState({error:t.formatError(a),hideForm:!0}):t.setState({account:a.account,hideForm:!1})}))}},{key:"render",value:function(){return F(this.props.token)?r.a.createElement("div",null,r.a.createElement("section",{className:"row no-border"},r.a.createElement("h2",null,A("store-account-assertion")),r.a.createElement("div",{className:"col-12"},r.a.createElement(V,{message:this.state.error}),r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"account"},A("account"),":",r.a.createElement("input",{type:"text",id:"account",onChange:this.handleChangeAccount,value:this.state.account.AuthorityID,placeholder:A("account-description")})),r.a.createElement("label",{htmlFor:"reseller"},A("reseller-features"),r.a.createElement("input",{className:"visible",type:"checkbox",id:"reseller",onChange:this.handleChangeReseller,checked:this.state.account.ResellerAPI})))),r.a.createElement("div",null,r.a.createElement("a",{href:"/accounts",className:"p-button--neutral"},A("cancel")),"\xa0",r.a.createElement("a",{href:"/accounts",onClick:this.handleSaveClick,className:"p-button--brand"},A("save"))),this.props.id?r.a.createElement("label",{htmlFor:"assertion"},A("assertion"),":",r.a.createElement("pre",null,this.state.account.Assertion)):"")),r.a.createElement("br",null)):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),ue=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChangeKeypair=function(e){e.preventDefault(),a.setState({keypairId:parseInt(e.target.value,10)})},a.handleFileUpload=function(e){var t=new FileReader,n=e.target.files[0];t.onload=function(e){a.setState({assertion:e.target.result.split(",")[1]})},t.readAsDataURL(n)},a.handleSaveClick=function(e){e.preventDefault(),W.assertion(a.state.keypairId,a.state.assertion).then((function(e){var t=D(e);t.success?window.location="/accounts":a.setState({error:O(t)})}))},a.state={keypairs:e.keypairs||[],keypairId:0,assertion:null,error:null},a.getKeypairs(),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getKeypairs",value:function(){var e=this;W.list().then((function(t){var a=JSON.parse(t.body),n="";a.success||(n=a.message),e.setState({keypairs:a.keypairs,message:n})}))}},{key:"render",value:function(){return F(this.props.token)?r.a.createElement("div",null,r.a.createElement("section",{className:"row no-border"},r.a.createElement("h2",null,A("new-account-key-assertion")),r.a.createElement("div",{className:"col-12"},r.a.createElement(V,{message:this.state.error}),r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"keypair"},A("private-key"),":",r.a.createElement("select",{value:this.state.keypairId,id:"keypair",onChange:this.handleChangeKeypair},r.a.createElement("option",null),this.state.keypairs.map((function(e){return e.Active?r.a.createElement("option",{key:e.ID,value:e.ID},e.AuthorityID,"/",e.KeyID):r.a.createElement("option",{key:e.ID,value:e.ID},e.AuthorityID,"/",e.KeyID," (",A("inactive"),")")})))),r.a.createElement("label",{htmlFor:"key"},A("assertion"),":",r.a.createElement("input",{type:"file",onChange:this.handleFileUpload})))),r.a.createElement("div",null,r.a.createElement("a",{href:"/accounts",className:"p-button--neutral"},A("cancel")),"\xa0",r.a.createElement("a",{href:"/accounts",onClick:this.handleSaveClick,className:"p-button--brand"},A("save"))))),r.a.createElement("br",null)):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),me=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleToggle=function(e){"false"===e.target.getAttribute("aria-checked")?W.enable(e.target.getAttribute("data-key")).then(a.props.refresh):W.disable(e.target.getAttribute("data-key")).then(a.props.refresh)},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderRow",value:function(e){return r.a.createElement("tr",{key:e.ID},r.a.createElement("td",{className:"small"},r.a.createElement("a",{href:"/signing-keys/"+e.ID,className:"p-button--brand small",title:A("edit-keypair")},r.a.createElement("i",{className:"fa fa-edit"}))),r.a.createElement("td",{className:"overflow",title:e.AuthorityID},e.AuthorityID),r.a.createElement("td",{className:"overflow",title:e.KeyID},e.KeyID),r.a.createElement("td",null,r.a.createElement("button",{"data-key":e.ID,id:"key-toggle",className:"p-switch",type:"button",role:"switch","aria-checked":e.Active,"aria-labelledby":"key-toggle",onClick:this.handleToggle},r.a.createElement("span",{"data-key":e.ID,"aria-checked":e.Active},"On"),r.a.createElement("span",{"data-key":e.ID,"aria-checked":e.Active},"Off"))),r.a.createElement("td",{className:"overflow",title:e.KeyName},e.KeyName))}},{key:"render",value:function(){var e=this;return this.props.keypairs.length>0?r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"small"}),r.a.createElement("th",null,A("authority-id")),r.a.createElement("th",null,A("key-id")),r.a.createElement("th",{className:"small"},A("active")),r.a.createElement("th",null,A("key-name")))),r.a.createElement("tbody",null,this.props.keypairs.map((function(t){return e.renderRow(t)})))):r.a.createElement("p",null,A("no-signing-keys-found"))}}]),t}(n.Component),de=a(68),he=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).poll=function(){Object(de.setTimeout)(a.getKeypairs.bind(Object(m.a)(a)),3e4)},a.state={keypairs:[]},a.getKeypairs(),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getKeypairs",value:function(){var e=this;W.status().then((function(t){var a=JSON.parse(t.body),n="";a.success||(n=a.message),e.setState({keypairs:a.status,message:n})})).done((function(){e.poll()}))}},{key:"renderRow",value:function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",{className:"overflow",title:e["authority-id"]},e["authority-id"]),r.a.createElement("td",{className:"overflow",title:e["key-name"]},e["key-name"]),r.a.createElement("td",{className:"overflow",title:e.status},A(e.status)))}},{key:"render",value:function(){var e=this;return this.state.keypairs.length>0?r.a.createElement("div",{className:"p-card--highlighted spacer"},r.a.createElement("table",null,r.a.createElement("tbody",null,this.state.keypairs.map((function(t){return e.renderRow(t)}))))):r.a.createElement("span",null)}}]),t}(n.Component),pe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleRefresh=function(){a.refresh()},a.state={confirmDelete:null,message:null},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){this.props.onRefresh(this.props.selectedAccount)}},{key:"formatError",value:function(e){var t=A(e.error_code);return e.error_subcode?t+=": "+A(e.error_subcode):e.message&&(t+=": "+e.message),t}},{key:"render",value:function(){return F(this.props.token)?r.a.createElement("div",{className:"row"},r.a.createElement("section",{className:"row"},r.a.createElement("div",{className:"u-equal-height spacer"},r.a.createElement("h2",{className:"col-3"},A("signing-keys")),"\xa0",r.a.createElement("div",{className:"col-1"},r.a.createElement("a",{href:"/signing-keys/new",className:"p-button--brand",title:A("add-new-signing-key")},r.a.createElement("i",{className:"fa fa-plus"}))),r.a.createElement("div",{className:"col-1"},r.a.createElement("a",{href:"/signing-keys/generate",className:"p-button--brand",title:A("generate-signing-key")},r.a.createElement("i",{className:"fa fa-cog"}))),r.a.createElement("div",{className:"col-1"},r.a.createElement("a",{href:"/signing-keys/store",className:"p-button--brand",title:A("register-signing-key")},r.a.createElement("i",{className:"fa fa-shopping-cart"})))),r.a.createElement("div",{className:"col-12"},r.a.createElement(he,{token:this.props.token})),r.a.createElement("div",{className:"col-12"},r.a.createElement(me,{keypairs:this.props.keypairs,refresh:this.handleRefresh})))):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),ge=a(30),fe=a.n(ge),ve=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("tr",null,r.a.createElement("td",{className:"wrap"},this.props.log.make),r.a.createElement("td",{className:"wrap"},this.props.log.model),r.a.createElement("td",{className:"wrap"},this.props.log.serialnumber),r.a.createElement("td",null,this.props.log.revision),r.a.createElement("td",{className:"overflow",title:this.props.log.fingerprint},this.props.log.fingerprint),r.a.createElement("td",{className:"wrap"},fe()(this.props.log.created).format("YYYY-MM-DD HH:mm")))}}]),t}(n.Component),ye={url:"signinglog",list:function(e){var t={};return e&&(t.fromID=e),y.get(this.url,t)},listForAccount:function(e,t,a,n){return y.get(this.url+"/account/"+e,{offset:t,filter:a,serialnumber:n})},filters:function(e){return y.get(this.url+"/account/"+e+"/filters")},download:function(e,t,a){y.get(this.url+"/account/"+e,{all:!0,filter:t,serialnumber:a}).then((function(e){var t=JSON.parse(e.body),a=["data:text/csv;charset=utf-8,ID,Make,Model,Serial Number,Revision,Fingerprint,Date"];t.logs.forEach((function(e,t){var n=[e.id,e.make,e.model,e.serialnumber,e.revision,e.fingerprint,e.created].join(",");a.push(n)}));var n=a.join("\n"),r=encodeURI(n),s=document.createElement("a");s.href=r,s.download="SigningLogs.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s)}))}},Ee=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.expanded?r.a.createElement("div",{className:"filter-section"},r.a.createElement("h5",{onClick:this.props.expansionClick.bind(this,this.props.keyName),className:"expanded"},this.props.name),r.a.createElement("ul",null,this.props.items.map((function(e,t){return r.a.createElement("li",{key:t,onClick:this.props.handleItemClick.bind(this,t,this.props.keyName)},r.a.createElement("span",{className:e.selected?"checked overflow":"unchecked overflow"},e.name))}),this))):r.a.createElement("div",{className:"filter-section"},r.a.createElement("h5",{className:"collapsed",onClick:this.props.expansionClick.bind(this,this.props.keyName)},this.props.name))}}]),t}(n.Component),ke=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).pageUp=function(){var e=a.calculatePages(),t=a.state.page+1;t>e&&(t=e),a.setState({page:t}),a.signalPageChange(t)},a.pageDown=function(){var e=a.state.page-1;e<=0&&(e=1),a.setState({page:e}),a.signalPageChange(e)},a.state={page:1,query:null,maxRecords:50},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"signalPageChange",value:function(e){var t=(e-1)*this.state.maxRecords;this.props.pageChange(t,this.props.filterString,this.props.query)}},{key:"calculatePages",value:function(){var e=this.props.totalLogs,t=parseInt(e/this.state.maxRecords,10);return e%this.state.maxRecords>0&&(t+=1),this.state.page>t&&t>0&&this.setState({page:t}),t}},{key:"renderPaging",value:function(){var e=this.calculatePages();return e>1?r.a.createElement("div",{className:"u-float--right"},r.a.createElement("button",{className:"p-button--neutral",href:"",onClick:this.pageDown},"\xab"),r.a.createElement("span",null,"\xa0",this.state.page," of ",e,"\xa0"),r.a.createElement("button",{className:"p-button--neutral",href:"",onClick:this.pageUp},"\xbb")):r.a.createElement("div",{className:"col-3"})}},{key:"render",value:function(){return r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-9"},r.a.createElement("input",{type:"search",placeholder:this.props.searchText,onChange:this.props.onSearchChange,value:this.props.query})),this.renderPaging()),r.a.createElement("div",{className:"row spacer"},r.a.createElement("div",{className:"col-6"},r.a.createElement("button",{className:"p-button--brand",onClick:this.props.onDownload},A("download")))))}}]),t}(n.Component),be=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleExpansionClick=function(e){var t=a.state.expanded;t[e]=!t[e],a.setState({expanded:t})},a.handleItemClick=function(e,t){var n;if("models"===t){(n=a.state.filterModels)[e].selected=!n[e].selected;var r=n.filter((function(e){return!0===e.selected})).map((function(e){return e.name})).join(",");a.getSigningLogs(0,r,a.state.query),a.setState({filterModels:n,filterString:r})}},a.getSigningLogs=function(e,t,n){ye.listForAccount(a.state.authorityID,e,t,n).then((function(e){var t=JSON.parse(e.body),n=null;t.success||(n=t.message),a.setState({logs:t.logs,message:n,totalLogs:t.total_count})}))},a.getSigningLogFilters=function(){ye.filters(a.state.authorityID).then((function(e){var t=JSON.parse(e.body),n="";t.success||(n=t.message);var r=t.filters.models.map((function(e){return{name:e,selected:!1}}));a.setState({filterModels:r,message:n})}))},a.handleSearchChange=function(e){a.getSigningLogs(0,a.state.filterString,e.target.value),a.setState({query:e.target.value})},a.handleDownload=function(){ye.download(a.state.authorityID,a.state.filterString,a.state.query)},a.state={logs:[],filterModels:[],filterString:"",message:null,expanded:{models:!0},query:"",startRow:0,endRow:50,totalLogs:0,authorityID:a.props.selectedAccount.AuthorityID},a.getSigningLogs(0,"",""),a.getSigningLogFilters(a.state.authorityID),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"selectedFilters",value:function(e){var t=[];return e.map((function(e){return e.selected&&t.push(e.name),e.name})),t}},{key:"renderTable",value:function(e){return this.state.logs.length>0?r.a.createElement("div",null,r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,A("brand")),r.a.createElement("th",null,A("model")),r.a.createElement("th",null,A("serial-number")),r.a.createElement("th",null,A("revision")),r.a.createElement("th",null,A("fingerprint")),r.a.createElement("th",null,A("date")))),r.a.createElement("tbody",null,this.renderRows(e)))):r.a.createElement("p",null,"No models signed.")}},{key:"renderRows",value:function(e){return e.map((function(e){return r.a.createElement(ve,{key:e.id,log:e})}))}},{key:"render",value:function(){return F(this.props.token)?r.a.createElement("div",{className:"row"},r.a.createElement("section",{className:"row"},r.a.createElement("h2",null,A("signinglog")),r.a.createElement("div",{className:"col-12"},r.a.createElement("p",null,A("signinglog-description"))),r.a.createElement("div",{className:"col-12"},r.a.createElement(V,{message:this.state.message})),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},r.a.createElement("div",{className:"p-card filter"},r.a.createElement("div",{className:"filter-section"},r.a.createElement("h4",null,"Filter By"),r.a.createElement(Ee,{name:A("models"),items:this.state.filterModels,keyName:"models",handleItemClick:this.handleItemClick,expanded:this.state.expanded.models,expansionClick:this.handleExpansionClick})))),r.a.createElement("div",{className:"col-9"},r.a.createElement(ke,{totalLogs:this.state.totalLogs,query:this.state.query,searchText:A("find-serialnumber"),pageChange:this.getSigningLogs,filterString:this.state.filterString,onDownload:this.handleDownload,onSearchChange:this.handleSearchChange}),this.renderTable(this.state.logs))))):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),Ne=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleChangeSerial=function(e){e.preventDefault(),a.props.onChange("serialnumber",e.target.value)},a.handleChangeSubstore=function(e){e.preventDefault(),a.props.onChange("store",e.target.value)},a.handleChangeFromModel=function(e){e.preventDefault(),a.props.onChange("fromModelID",parseInt(e.target.value,10))},a.handleChangeModelName=function(e){e.preventDefault(),a.props.onChange("modelname",e.target.value)},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.substore;return r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"5"},r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"fromModel"},A("model"),":",r.a.createElement("select",{value:e.fromModelID,id:"fromModel",onChange:this.handleChangeFromModel},r.a.createElement("option",null),this.props.models.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.model)})))),r.a.createElement("label",{htmlFor:"serial"},A("serial-number"),":",r.a.createElement("input",{type:"text",id:"serial",placeholder:A("serial-number-description"),value:e.serialnumber,onChange:this.handleChangeSerial})),r.a.createElement("label",{htmlFor:"substore"},A("substore"),":",r.a.createElement("input",{type:"text",id:"substore",placeholder:A("substore-description"),value:e.store,onChange:this.handleChangeSubstore})),r.a.createElement("label",{htmlFor:"modelname"},A("modelname"),":",r.a.createElement("input",{type:"text",id:"modelname",placeholder:A("modelname-description"),value:e.modelname,onChange:this.handleChangeModelName}))),F(this.props.token)?r.a.createElement("span",null,r.a.createElement("button",{className:"p-button--neutral",onClick:this.props.onCancel,"data-key":e.id},A("cancel")),r.a.createElement("button",{className:"p-button--brand",onClick:this.props.onSave,"data-key":e.id},A("save"))):r.a.createElement("button",{className:"p-button--neutral",onClick:this.props.onCancel,"data-key":e.id},A("close")))))}}]),t}(n.Component),Ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleShowNew=function(e){e.preventDefault(),a.setState({showNew:!0,showEdit:null,showDelete:null,substore:{}})},a.handleShowEdit=function(e){e.preventDefault();var t=parseInt(e.target.getAttribute("data-key"),10);if(a.state.showEdit===t)a.setState({showEdit:null,substore:{},showDelete:null,showNew:!1});else{var n=a.props.substores.filter((function(e){return e.id===t}));a.setState({substore:n[0],showEdit:t,showDelete:null,showNew:!1})}},a.handleShowDelete=function(e){e.preventDefault();var t=parseInt(e.target.getAttribute("data-key"),10);if(a.state.showDelete===t)a.setState({showDelete:null,showEdit:null,showNew:!1});else{var n=a.props.substores.filter((function(e){return e.id===t}));a.setState({substore:n[0],showDelete:t,showEdit:null,showNew:!1})}},a.handleSubstoreChange=function(e,t){var n=a.state.substore;n[e]=t,a.setState({substore:n})},a.handleSaveSubstore=function(e){e.preventDefault(),F(a.props.token)||(window.location="/accounts"),a.state.substore.id?oe.storeUpdate(a.state.substore).then((function(e){var t=JSON.parse(e.body);e.statusCode>=300?a.setState({error:O(t)}):(a.props.onRefresh(a.props.selectedAccount),a.setState({substore:{},showNew:!1,showEdit:null,showDelete:null,error:null}))})):oe.storeNew(a.props.selectedAccount.ID,a.state.substore).then((function(e){var t=JSON.parse(e.body);e.statusCode>=300?a.setState({error:O(t)}):(a.setState({substore:{},showNew:!1,showEdit:null,showDelete:null,error:null}),a.props.onRefresh(a.props.selectedAccount))}))},a.handleDeleteSubstore=function(e){e.preventDefault(),oe.storeDelete(a.state.substore).then((function(e){var t=JSON.parse(e.body);e.statusCode>=300?a.setState({error:O(t)}):(a.props.onRefresh(a.props.selectedAccount),a.setState({substore:{},showNew:!1,showEdit:null,showDelete:null,error:null}))}))},a.handleCancelSubstore=function(e){e.preventDefault(),a.setState({substore:{},showNew:!1,showEdit:null,showDelete:null,error:null}),a.props.onRefresh(a.props.selectedAccount)},a.state={error:null,showNew:!1,showEdit:null,showDelete:null,substore:{}},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderActions",value:function(e){return this.state.showDelete===e.id?r.a.createElement(Z,{message:A("confirm-store-delete"),handleYesClick:this.handleDeleteSubstore,handleCancelClick:this.handleCancelSubstore,small:!0}):r.a.createElement("div",null,r.a.createElement("a",{href:"","data-key":e.id,onClick:this.handleShowEdit,className:"p-button--brand small",title:A("edit-model")},r.a.createElement("i",{"data-key":e.id,className:"fa fa-pencil"})),"\xa0",r.a.createElement("a",{href:"","data-key":e.id,onClick:this.handleShowDelete,className:"p-button--neutral small",title:A("delete-model")},r.a.createElement("i",{"data-key":e.id,className:"fa fa-trash"})))}},{key:"renderSubstore",value:function(e){return r.a.createElement("tr",null,r.a.createElement("td",null,this.renderActions(e)),r.a.createElement("td",{className:"overflow",title:e.fromModel.model},e.fromModel.model),r.a.createElement("td",{className:"overflow",title:e.serialnumber},e.serialnumber),r.a.createElement("td",{className:"overflow",title:e.store},e.store),r.a.createElement("td",{className:"overflow",title:e.modelname},e.modelname))}},{key:"render",value:function(){var e=this;return F(this.props.token)?r.a.createElement("div",null,r.a.createElement("section",{className:"row no-border"},r.a.createElement("div",null,r.a.createElement("div",{className:"u-equal-height"},r.a.createElement("h2",{className:"p-card__title col-5"},A("substores")),"\xa0",r.a.createElement("div",{className:"col-1"},r.a.createElement("a",{href:"",onClick:this.handleShowNew,className:"p-button--brand",title:A("new-substore-device")},r.a.createElement("i",{className:"fa fa-plus"})))),r.a.createElement(V,{message:this.state.error}),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,A("model")),r.a.createElement("th",null,A("serial-number")),r.a.createElement("th",null,A("substore")),r.a.createElement("th",null,A("substore-model")))),r.a.createElement("tbody",null,this.state.showNew?r.a.createElement(Ne,{substore:this.state.substore,models:this.props.models,token:this.props.token,onSave:this.handleSaveSubstore,onChange:this.handleSubstoreChange,onCancel:this.handleCancelSubstore}):"",this.props.substores.map((function(t){return t.id===e.state.showEdit?r.a.createElement(Ne,{substore:e.state.substore,models:e.props.models,token:e.props.token,onSave:e.handleSaveSubstore,onChange:e.handleSubstoreChange,onCancel:e.handleCancelSubstore}):e.renderSubstore(t)}))))))):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),we={url:"assertions",create:function(e){return console.log("Assertion.create"),y.post(this.url,e)}},Se=a(54),Ae=a.n(Se),De=(a(100),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).onShowForm=function(e){e.preventDefault(),a.setState({assertion:null})},a.handleChangeEmail=function(e){a.setState({email:e.target.value})},a.handleChangeUsername=function(e){a.setState({username:e.target.value})},a.handleChangePassword=function(e){a.setState({password:e.target.value})},a.handleChangeName=function(e){a.setState({name:e.target.value})},a.handleChangeModel=function(e){a.setState({model:parseInt(e.target.value,10)})},a.handleChangeSinceDate=function(e){e.hours(a.state.since.hours()),e.minutes(a.state.since.minutes()),e.seconds(a.state.since.seconds()),a.setState({since:e})},a.handleChangeSinceTime=function(e){var t=e.target.value.split(":"),n=a.state.since;n.hours(t[0]),n.minutes(t[1]),n.seconds(0),a.setState({since:n})},a.handleChangeUntilDate=function(e){e.hours(a.state.until.hours()),e.minutes(a.state.until.minutes()),e.seconds(a.state.until.seconds()),a.setState({until:e})},a.handleChangeUntilTime=function(e){var t=e.target.value.split(":"),n=a.state.until;n.hours(t[0]),n.minutes(t[1]),n.seconds(0),a.setState({until:n})},a.onSubmit=function(e){e.preventDefault();var t={email:a.state.email,username:a.state.username,password:a.state.password,name:a.state.name,model:a.state.model,since:a.state.since.format("YYYY-MM-DDTHH:mm:ss")+"Z",until:a.state.until.format("YYYY-MM-DDTHH:mm:ss")+"Z"};a.validate(t)&&a.submitAssertion(t)},a.state={email:"",username:"",password:"",name:"",model:0,since:fe.a.utc(),until:fe.a.utc().add(1,"year"),message:"",assertion:null},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"submitAssertion",value:function(e){var t=this;we.create(e).then((function(e){var a=JSON.parse(e.body),n=null;a.success||(n=a.message),a.success?t.setState({assertion:a.assertion,message:n}):t.setState({message:n})}))}},{key:"downloadAssertion",value:function(){return"data:application/octet-stream;charset=utf-8,"+encodeURIComponent(this.state.assertion)}},{key:"validate",value:function(e){return e.email&&e.username&&e.password&&e.name&&e.model&&0!==e.model?/^[a-zA-Z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e.email)?(this.setState({message:""}),!0):(this.setState({message:"The email is not valid"}),!1):(this.setState({message:"All the fields must be entered"}),!1)}},{key:"render",value:function(){return j(this.props.token)?this.state.assertion?r.a.createElement("div",{className:"row"},r.a.createElement("a",{href:"#form",onClick:this.onShowForm},"\xab Back to the form"),r.a.createElement("h3",null,"System User Assertion"),r.a.createElement("pre",null,this.state.assertion),r.a.createElement("a",{className:"p-button--brand",href:this.downloadAssertion(),download:"auto-import.assert"},"Download")):r.a.createElement("div",{className:"row"},r.a.createElement("h2",null,A("create-system-user")),r.a.createElement(V,{message:this.state.message,type:"negative"}),r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"email"},"Email:",r.a.createElement("input",{type:"email",name:"email",required:!0,placeholder:"email address",onChange:this.handleChangeEmail,value:this.state.email})),r.a.createElement("label",{htmlFor:"username"},"Username:",r.a.createElement("input",{type:"text",name:"username",placeholder:"system-user name",onChange:this.handleChangeUsername,value:this.state.username})),r.a.createElement("label",{htmlFor:"password"},"Password:",r.a.createElement("input",{type:"password",name:"password",placeholder:"password for the system-user",onChange:this.handleChangePassword,value:this.state.password})),r.a.createElement("label",{htmlFor:"name"},"Full Name:",r.a.createElement("input",{type:"text",name:"name",placeholder:"name of the user",onChange:this.handleChangeName,value:this.state.name})),r.a.createElement("label",{htmlFor:"name"},"Model:",r.a.createElement("select",{onChange:this.handleChangeModel,value:this.state.model.id},r.a.createElement("option",{value:0},"--"),this.props.models.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e["brand-id"]," ",e.model)})))),r.a.createElement("label",{htmlFor:"since"},"Since (UTC):",r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},r.a.createElement(Ae.a,{selected:this.state.since,onChange:this.handleChangeSinceDate})),r.a.createElement("div",{className:"col-3"},r.a.createElement("input",{type:"time",name:"since_time",title:"the time the assertion is valid from (UTC)",onChange:this.handleChangeSinceTime,value:this.state.since.format("HH:mm")})))),r.a.createElement("label",{htmlFor:"until"},"Until (UTC):",r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},r.a.createElement(Ae.a,{selected:this.state.until,onChange:this.handleChangeUntilDate})),r.a.createElement("div",{className:"col-3"},r.a.createElement("input",{type:"time",name:"until_time",title:"the time the assertion is valid until (UTC)",onChange:this.handleChangeUntilTime,value:this.state.until.format("HH:mm")}))))),r.a.createElement("button",{className:"p-button--brand",onClick:this.onSubmit},"Create"))):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component)),Oe=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=0;return r.a.createElement("nav",{className:"p-tabs"},r.a.createElement("ul",{className:"p-tabs__list",role:"tablist"},this.props.items.map((function(a){return t+=1,r.a.createElement("li",{className:"p-tabs__item",role:"presentation"},r.a.createElement("a",{href:"/"+a,className:"p-tabs__link",tabIndex:t,role:"tab","aria-controls":a,"aria-selected":a===e.props.selected},A(a)))}))))}}]),t}(n.Component),Ie=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderActions",value:function(){return this.props.user.ID!==this.props.confirmDelete?r.a.createElement("div",null,r.a.createElement("a",{href:"/users/".concat(this.props.user.ID,"/edit"),className:"p-button--brand",title:A("edit-user")},r.a.createElement("i",{className:"fa fa-pencil"})),"\xa0",r.a.createElement("a",{href:"",onClick:this.props.delete,"data-key":this.props.user.ID,className:"p-button--neutral",title:A("delete-user")},r.a.createElement("i",{className:"fa fa-trash","data-key":this.props.user.ID}))):r.a.createElement(Z,{message:A("confirm-user-delete"),handleYesClick:this.props.deleteUser,handleCancelClick:this.props.cancelDelete})}},{key:"render",value:function(){return r.a.createElement("tr",null,r.a.createElement("td",null,this.renderActions()),r.a.createElement("td",{className:"overflow",title:this.props.user.Username},this.props.user.Username),r.a.createElement("td",{className:"overflow",title:this.props.user.Name},this.props.user.Name),r.a.createElement("td",{className:"overflow",title:this.props.user.Email},this.props.user.Email),r.a.createElement("td",{className:"overflow",title:_(this.props.user.Role)},_(this.props.user.Role)),r.a.createElement("td",{className:"overflow",title:this.props.user.APIKey},this.props.user.APIKey))}}]),t}(n.Component),je={url:"users",list:function(){return y.get(this.url)},get:function(e){return y.get(this.url+"/"+e)},getotheraccounts:function(e){return y.get(this.url+"/"+e+"/otheraccounts")},update:function(e){return y.put(this.url+"/"+e.id,e)},delete:function(e){return y.delete(this.url+"/"+e.ID,{})},create:function(e){return y.post(this.url,e)}},Fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleRefresh=function(){a.refresh()},a.handleDelete=function(e){e.preventDefault(),a.setState({confirmDelete:parseInt(e.target.getAttribute("data-key"),10)})},a.handleDeleteUser=function(e){e.preventDefault();var t=a.state.users.filter((function(e){return e.ID===a.state.confirmDelete}));0!==t.length&&je.delete(t[0]).then((function(e){var t=JSON.parse(e.body);e.statusCode>=300||!t.success?a.setState({message:a.formatError(t)}):window.location="/users"}))},a.handleDeleteUserCancel=function(e){e.preventDefault(),a.setState({confirmDelete:null})},a.state={users:a.props.users||[],confirmDelete:null,message:null},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){this.getUsers()}},{key:"getUsers",value:function(){var e=this;je.list().then((function(t){var a=JSON.parse(t.body),n="";a.success||(n=a.message),e.setState({users:a.users,message:n})}))}},{key:"formatError",value:function(e){var t=A(e.error_code);return e.error_subcode?t+=": "+A(e.error_subcode):e.message&&(t+=": "+e.message),t}},{key:"renderTable",value:function(){var e=this;return this.state.users.length>0?r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,A("username")),r.a.createElement("th",null,A("name")),r.a.createElement("th",null,A("email")),r.a.createElement("th",null,A("role")),r.a.createElement("th",null,A("api-key")))),r.a.createElement("tbody",null,this.state.users.map((function(t){return r.a.createElement(Ie,{key:t.ID,user:t,delete:e.handleDelete,confirmDelete:e.state.confirmDelete,deleteUser:e.handleDeleteUser,cancelDelete:e.handleDeleteUserCancel})})))):r.a.createElement("p",null,"No users found.")}},{key:"render",value:function(){return K(this.props.token)?r.a.createElement("div",{className:"row"},r.a.createElement("section",{className:"row"},r.a.createElement("div",{className:"u-equal-height"},r.a.createElement("h2",{className:"col-3"},A("users")),"\xa0",r.a.createElement("div",{className:"col-1"},r.a.createElement("a",{href:"/users/new",className:"p-button--brand",title:A("add-new-user")},r.a.createElement("i",{className:"fa fa-plus"})))),r.a.createElement("div",{className:"col-12"},r.a.createElement("p",null,A("users_available"),":")),r.a.createElement("div",{className:"col-12"},r.a.createElement(V,{message:this.state.message})),r.a.createElement("div",{className:"col-12"},this.renderTable()))):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),Ke=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).buildSelectBoxOption=function(e){return r.a.createElement("option",{key:e,value:e},e)},a.handleChangeUsername=function(e){var t=a.state.user;t.Username=e.target.value,a.setState({user:t})},a.handleChangeName=function(e){var t=a.state.user;t.Name=e.target.value,a.setState({user:t})},a.handleChangeEmail=function(e){var t=a.state.user;t.Email=e.target.value,a.setState({user:t})},a.handleChangeRole=function(e){var t=a.state.user;t.Role=parseInt(e.target.value,10),a.setState({user:t})},a.handleSaveClick=function(e){e.preventDefault();var t=a.buildRequestData();t.id?je.update(t).then((function(e){var t=JSON.parse(e.body);e.statusCode>=300?a.setState({error:a.formatError(t)}):window.location="/users"})):je.create(t).then((function(e){var t=JSON.parse(e.body);e.statusCode>=300?a.setState({error:a.formatError(t)}):window.location="/users"}))},a.handleClickAccount=function(e){e.preventDefault();var t=e.target.getAttribute("data-account"),n=a.state.assignedAccounts,r=a.state.assignedAccounts.indexOf(t);r<0?n.push(t):n.splice(r,1),a.setState({assignedAccounts:n})},a.state={title:null,user:{},error:null,hideForm:!1,assignedAccounts:[],availableAccounts:[]},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.id?(this.setTitle("edit-user"),this.getUser(this.props.id)):this.setTitle("new-user"),this.getAllAccounts()}},{key:"setTitle",value:function(e){this.setState({title:A(e)})}},{key:"getUser",value:function(e){var t=this;je.get(e).then((function(e){var a=JSON.parse(e.body);e.statusCode>=300?t.setState({error:t.formatError(a),hideForm:!0}):t.setState({user:a.user,assignedAccounts:t.accountsToAuthorityIDs(a.user.Accounts),hideForm:!1})}))}},{key:"getAllAccounts",value:function(){var e=this;oe.list().then((function(t){var a=JSON.parse(t.body);e.setState({availableAccounts:e.accountsToAuthorityIDs(a.accounts)})}))}},{key:"accountsToAuthorityIDs",value:function(e){for(var t=[],a=0;a<e.length;++a)t.push(e[a].AuthorityID);return t}},{key:"formatError",value:function(e){var t=A(e.error_code);return e.error_subcode?t+=": "+A(e.error_subcode):e.message&&(t+=": "+e.message),t}},{key:"buildRequestData",value:function(){var e={},t=this.state.user;return e.id=t.ID,e.username=t.Username,e.name=t.Name,e.email=t.Email,e.role=t.Role,e.api_key=t.APIKey,e.accounts=this.state.assignedAccounts,e}},{key:"renderAccountSelect",value:function(e){var t="p-button--neutral";return this.state.assignedAccounts.indexOf(e)>=0&&(t="p-button--brand"),r.a.createElement("button",{key:e,"data-account":e,onClick:this.handleClickAccount,className:t},e)}},{key:"renderError",value:function(){if(this.state.error)return r.a.createElement(V,{message:this.state.error})}},{key:"render",value:function(){var e=this;return K(this.props.token)?this.state.hideForm?r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:this.state.error})):r.a.createElement("div",{className:"row"},r.a.createElement("section",{className:"row"},r.a.createElement("h2",null,this.state.title),r.a.createElement(V,{message:this.state.error}),r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"username"},A("username"),":",r.a.createElement("input",{type:"text",id:"username",placeholder:A("user-username"),value:this.state.user.Username,onChange:this.handleChangeUsername})),r.a.createElement("label",{htmlFor:"name"},A("name"),":",r.a.createElement("input",{type:"text",id:"name",placeholder:A("user-name"),value:this.state.user.Name,onChange:this.handleChangeName})),r.a.createElement("label",{htmlFor:"email"},A("email"),":",r.a.createElement("input",{type:"text",id:"email",placeholder:A("user-email"),value:this.state.user.Email,onChange:this.handleChangeEmail})),r.a.createElement("label",{htmlFor:"role"},A("role"),":",r.a.createElement("select",{value:this.state.user.Role,id:"role",onChange:this.handleChangeRole},r.a.createElement("option",null),r.a.createElement("option",{key:"standard",value:"100"},"Standard"),r.a.createElement("option",{key:"syncuser",value:"150"},"Sync API"),r.a.createElement("option",{key:"admin",value:"200"},"Admin"),r.a.createElement("option",{key:"superuser",value:"300"},"Superuser"))),r.a.createElement("label",{htmlFor:"api-key"},A("api-key"),":",r.a.createElement("input",{type:"text",id:"api-key",placeholder:A("api-key"),value:this.state.user.APIKey,readOnly:!0}))),r.a.createElement("h3",null,A("user-accounts")),r.a.createElement("fieldset",null,r.a.createElement("p",null,A("select-accounts")),r.a.createElement("div",null,this.state.availableAccounts.map((function(t){return e.renderAccountSelect(t)}))))),r.a.createElement("div",null,r.a.createElement("a",{href:"/users",className:"p-button--neutral"},A("cancel")),"\xa0",r.a.createElement("a",{href:"/users",onClick:this.handleSaveClick,className:"p-button--brand"},A("save")))),r.a.createElement("br",null)):r.a.createElement("div",{className:"row"},r.a.createElement(V,{message:A("error-no-permissions")}))}}]),t}(n.Component),_e=a(71),Te=a.n(_e),Me=(a(161),Te()()),Ue=["models","substores","systemuser"],xe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleAccountChange=function(e){M(e),a.setState({selectedAccount:e}),a.updateDataForRoute(e)},a.state={location:Me.location,token:e.token||{},models:[],accounts:[],keypairs:[],substores:[],selectedAccount:U()||{}},Me.listen(a.handleNavigation.bind(Object(m.a)(a))),a.getAccounts(),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"handleNavigation",value:function(e){this.setState({location:e}),window.scrollTo(0,0)}},{key:"getAccounts",value:function(){var e=this;I(this.props.token)&&oe.list().then((function(t){var a=JSON.parse(t.body),n="";a.success||(n=a.message);var r=e.state.selectedAccount;if(e.state.selectedAccount.ID||U().AuthorityID){if(a.accounts.length>0){var s=a.accounts.filter((function(t){return e.state.selectedAccount.ID===t.ID}));s.length>0&&M(r=s[0])}}else a.accounts.length>0&&M(r=a.accounts[0]);e.updateDataForRoute(r),e.setState({accounts:a.accounts,selectedAccount:r,message:n})}))}},{key:"getKeypairs",value:function(e){var t=this;W.list().then((function(a){var n=JSON.parse(a.body),r="";n.success||(r=n.message);var s=n.keypairs.filter((function(t){return t.AuthorityID===e}));t.setState({keypairs:s,message:r})}))}},{key:"getModels",value:function(e){var t=this;$.list().then((function(a){var n=JSON.parse(a.body),r="";n.success||(r=n.message);var s=n.models.filter((function(t){return t["brand-id"]===e}));t.setState({models:s,message:r})}))}},{key:"getSubstores",value:function(e){var t=this;oe.stores(e).then((function(e){var a=JSON.parse(e.body);e.statusCode>=300?t.setState({message:O(a),hideForm:!0}):t.setState({substores:a.substores,message:null})}))}},{key:"updateDataForRoute",value:function(e){var t=w(window.location.pathname);"accounts"===t&&this.getKeypairs(e.AuthorityID),"signing-keys"===t&&this.getKeypairs(e.AuthorityID),"models"===t&&(this.getModels(e.AuthorityID),this.getKeypairs(e.AuthorityID)),"substores"===t&&(e.ID&&this.getSubstores(e.ID),this.getModels(e.AuthorityID)),"systemuser"===t&&this.getModels(e.AuthorityID)}},{key:"renderModels",value:function(){var e=S(window.location.pathname,"models");switch(e){case"new":return r.a.createElement(te,{token:this.props.token,id:null,selectedAccount:this.state.selectedAccount,keypairs:this.state.keypairs});case"":return r.a.createElement(ee,{token:this.props.token,selectedAccount:this.state.selectedAccount,models:this.state.models});default:return r.a.createElement(te,{token:this.props.token,id:e,selectedAccount:this.state.selectedAccount,keypairs:this.state.keypairs})}}},{key:"renderAccounts",value:function(){var e=S(window.location.pathname,"accounts"),t=function(e,t){var a=e.split("/").slice(1);return a[0]===t&&a[2]||""}(window.location.pathname,"accounts");switch(e){case"upload":return r.a.createElement(ie,{token:this.props.token});case"new":return r.a.createElement(ce,{token:this.props.token});case"account":return r.a.createElement(ce,{id:t,token:this.props.token});case"key-assertion":return r.a.createElement(ue,{token:this.props.token});default:return r.a.createElement(le,{token:this.props.token,selectedAccount:this.state.selectedAccount,keypairs:this.state.keypairs})}}},{key:"renderUsers",value:function(){var e=S(window.location.pathname,"users");switch(e){case"new":return r.a.createElement(Ke,{token:this.props.token});case"":return r.a.createElement(Fe,{token:this.props.token});default:return r.a.createElement(Ke,{token:this.props.token,id:e})}}},{key:"renderKeypairs",value:function(){var e=S(window.location.pathname,"signing-keys");switch(e){case"generate":return r.a.createElement(re,{token:this.props.token,selectedAccount:this.state.selectedAccount});case"new":return r.a.createElement(ae,{token:this.props.token,selectedAccount:this.state.selectedAccount});case"":return r.a.createElement(pe,{token:this.props.token,selectedAccount:this.state.selectedAccount,keypairs:this.state.keypairs,onRefresh:this.handleAccountChange});case"store":return r.a.createElement(se,{token:this.props.token,selectedAccount:this.state.selectedAccount,keypairs:this.state.keypairs});default:return r.a.createElement(ne,{token:this.props.token,id:e})}}},{key:"render",value:function(){var e=w(window.location.pathname);return r.a.createElement("div",{className:"App"},r.a.createElement(Y,{token:this.props.token,accounts:this.state.accounts,selectedAccount:this.state.selectedAccount,onAccountChange:this.handleAccountChange}),r.a.createElement("div",{className:"spacer"}),!F(this.props.token)&&!K(this.props.token)||"models"!==e&&"substores"!==e&&"systemuser"!==e?"":r.a.createElement("section",{className:"row"},r.a.createElement(Oe,{items:Ue,selected:e})),"home"===e?r.a.createElement(G,{token:this.props.token}):"","notfound"===e?r.a.createElement(G,{token:this.props.token,error:!0}):"","signing-keys"===e?this.renderKeypairs():"","models"===e?this.renderModels():"","accounts"===e?this.renderAccounts():"","signinglog"===e?r.a.createElement(be,{token:this.props.token,selectedAccount:this.state.selectedAccount}):"","substores"===e?r.a.createElement(Ce,{token:this.props.token,selectedAccount:this.state.selectedAccount,onRefresh:this.handleAccountChange,substores:this.state.substores,models:this.state.models}):"","systemuser"===e?r.a.createElement(De,{token:this.props.token,models:this.state.models}):"","users"===e?this.renderUsers():"",r.a.createElement(H,null))}}]),t}(n.Component),Re=a(174);window.AppState={container:document.getElementById("main"),getLocale:function(){return localStorage.getItem("locale")||"en"},setLocale:function(e){localStorage.setItem("locale",e)},render:function(){var e,t=this,a=this.getLocale();e=function(e){l.a.render(r.a.createElement(Re.a,{locale:a,messages:h[a]},r.a.createElement(xe,{token:e})),t.container)},y.getAuthToken().then((function(t){if(JSON.parse(t.body).enableUserAuth){var a=t.headers.authorization;if(a){var n=g()(a);e(n||{})}else e({})}else e({role:b})}))},unmount:function(){l.a.unmountComponentAtNode(this.container)},rerender:function(){this.unmount(),this.render()}},window.AppState.render()},75:function(e,t,a){e.exports=a(169)}},[[75,1,2]]]);
//# sourceMappingURL=main.ac41bc73.chunk.js.map